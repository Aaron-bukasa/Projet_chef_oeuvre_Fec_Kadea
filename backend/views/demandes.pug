extends layout
  
block content
    div(class="demandes h-full grid grid-cols-1 grid-rows-[max-content,auto] gap-y-6")
        section(class="col-start-1 col-end-2 row-start-1 row-end-2")
            h1(class="text-center mb-3 font-extrabold text-xl md:text-2xl lg:text-3xl xl:text-4xl") Demandes d'adhésion
            div(class="flex justify-between gap-x-6")
                form(action="#", method="GET" class="border-4 p-3 my-3 h-max bg-gray-50 rounded-lg w-1/2")
                    h2(class='text-2xl font-bold mb-2') Filtres
                    div(class="flex justify-between gap-3 w-full")
                        div(class='mr-3 w-1/3')
                            label(for="etat") État
                            select(id="etat" name="etat" class="border rounded-lg p-2 my-1 w-full")
                                option(value="") Tous
                                optgroup(label="Confirmation")
                                    option(value='confirmed:' true) True
                                    option(value='confirmed:' false) False
                                optgroup(label="Forme juridique")
                                    option(value="forme_juridique: ETS") L’entreprise individuelle (ou établissement)
                                    option(value="forme_juridique: SARL") La Société à Responsabilité Limitée (S.A.R.L)
                                    option(value="forme_juridique: SA") La Société Anonyme (S.A)
                                    option(value="forme_juridique: SAS") La Société par Actions Simplifiées (S.A.S.)
                                    option(value="forme_juridique: SNC") La Société en Nom Collectif (S.N.C)
                                    option(value="forme_juridique: SNS") La Société en Commandite Simple (S.C.S)
                                    option(value="forme_juridique: GIE") Le Groupement d’Intérêt Economique (G.I.E)
                                optgroup(label="Province")
                                    option(value="province_activite_activite: Bas-Uele") Bas-Uele
                                    option(value="province_activite: Équateur") Équateur
                                    option(value="province_activite: Haut-Katanga") Haut-Katanga
                                    option(value="province_activite: Haut-Lomami") Haut-Lomami
                                    option(value="province_activite: Haut-Uele") Haut-Uele
                                    option(value="province_activite: Ituri") Ituri
                                    option(value="province_activite: Kasaï") Kasaï
                                    option(value="province_activite: Kasaï central") Kasaï central
                                    option(value="province_activite: Kasaï oriental") Kasaï oriental
                                    option(value="province_activite: Kinshasa") Kinshasa
                                    option(value="province_activite: Kongo-Central") Kongo-Central
                                    option(value="province_activite: Kwango") Kwango
                                    option(value="province_activite: Kwilu") Kwilu
                                    option(value="province_activite: Lomami") Lomami
                                    option(value="province_activite: Lualaba") Lualaba
                                    option(value="province_activite: Mai-Ndombe") Mai-Ndombe
                                    option(value="province_activite: Maniema") Maniema
                                    option(value="province_activite: Mongala") Mongala
                                    option(value="province_activite: Nord-Kivu") Nord-Kivu
                                    option(value="province_activite: Nord-Ubangi") Nord-Ubangi
                                    option(value="province_activite: Sankuru") Sankuru
                                    option(value="province_activite: Sud-Kivu") Sud-Kivu
                                    option(value="province_activite: Sud-Ubangi") Sud-Ubangi
                                    option(value="province_activite: Tanganyika") Tanganyika
                                    option(value="province_activite: Tshopo") Tshopo
                                    option(value="province_activite: Tshuapa") Tshuapa
                        div
                            label(for="date-debut") Date de début
                            input.date_debut(type="date", id="date-debut", name="date-debut" class="border-2 rounded-lg p-2 my-1")
                        div
                            label(for="date-fin") Date de fin
                            input.date_fin(type="date", id="date-fin", name="date-fin" class="border-2 rounded-lg p-2 my-1")
                    button.filter(type="button" class="bg-sky-blue p-2 font-bold text-white rounded-lg my-2 block w-full md:w-[180px]") Filtrer
                ul.statistic(class="p-3 flex flex-col my-3 gap-y-4 bg-gray-50 rounded-lg w-1/2")
                    h2(class='text-2xl font-bold mb-2') Les statistiques
                    div(class="flex gap-x-6")
                        div
                            li Nombre total de demandes: !{demandes.length}
                            li Nombre de demandes en attente: !{demandes.filter(demande => demande.statut === 'en attente').length}
                        div
                            li Nombre de demandes validées: !{demandes.filter(demande => demande.statut === 'validée').length}
                            li Nombre de demandes annulé: !{demandes.filter(demande => demande.statut === 'rejetée').length}
                    li(class="xl:flex") 
                        a(href="/demandes" class="p-3 bg-sky-blue rounded-lg text-white hover:opacity-80 font-semibold block my-4 text-center w-max xl:my-0")  Actualiser la page
        section.liste-demandes(class="bg-gray-50 p-3 rounded-lg col-start-1 col-end-2 row-start-2 row-end-3")
            h2(class="font-bold text-3xl mb-4") Listes des demandes
            table(class="w-full border-2 p-2 mb-6")
                thead.demandes
                    tr(class="py-2 bg-slate-200  border-b-2 border-slate-600")
                        th(class="text-center py-1 px-1") Numéro
                        th(class="text-center py-1 px-1") Date
                        th(class="text-center py-1 px-1") Nom
                        th(class="text-center py-1 px-1") Email
                        th(class="text-center py-1 px-1") Télephone
                        th(class="text-center py-1 px-1") Organisation
                        th(class="text-center py-1 px-1") Forme juridique
                        th(class="text-center py-1 px-1") Secteur d'activité
                        th(class="text-center py-1 px-1") province_activite d'activité
                        th(class="text-center py-1 px-1") Actions
                tbody.demandes
                    each demande in demandes
                        tr(class="even:bg-slate-200 border-b-2 border-slate-600")
                            td(class="text-center py-1 px-1")= demande.id
                            td(class="text-center py-1 px-1 text-nowrap")= demande.date_soumission.toLocaleDateString()
                            td(class="text-center py-1 px-1 text-nowrap capitalize")= demande.nom
                            td(class="text-center py-1 px-1")= demande.email
                            td(class="text-center py-1 px-1")= demande.telephone
                            td(class="text-center py-1 px-1")= demande.nom_organisation
                            td(class="text-center py-1 px-1")= demande.forme_juridique
                            td(class="text-center py-1 px-1")= demande.secteur_activite
                            td(class="text-center py-1 px-1")= demande.province_activite
                            td(class="text-center py-1 px-1")
                                a(href=`/demandes/${demande.requestId}` class="font-semibold text-sky-blue hover:text-sky-blue visited:text-sky-blue") Voir
                        
    script(src="/javascripts/demandes.js")
